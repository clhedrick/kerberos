<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<head><link href="../usertool.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../jquery-3.2.1.min.js" ></script>
<script type="text/javascript">
/*<![CDATA[*/
function deletegroup(event) {
  var group = $(event.target).next().val();
  if (!confirm("Are you sure you want to delete this group?"))
    return;
  $("#deleteInput").val(group);
  $("#deleteSubmit").click();
}

function deleteKeyPress(event) {
  // Check to see if space or enter were pressed
  if (event.keyCode === 32 || event.keyCode === 13) {
    // Prevent the default action to stop scrolling when space is pressed
    event.preventDefault();
    deletegroup(event);
  }
}

function validateSubmit(event) {
  if (! ($("#sharing").prop("checked") || $("#guests").prop("checked"))) {
    alert("Sharing and/or guests must be checked");
    event.preventDefault();
    return;
  }
  if ($("#name").val() == '') {
    alert("Name for the new group must be supplied");
    event.preventDefault();
    return;
  }
}

$(document).ready(function(){
    $(".deleteButton").click(deletegroup);
    $(".deleteButton").keypress(deleteKeyPress);
    $("#submit").click(validateSubmit);
    });

/*]]>*/
</script>
</head>
<div id="masthead"></div>
<div id="main">

<div class="messages">
<p th:each="msg : ${messages}" th:text="${msg}" />
</div>


<a href="../"> Account Management</a>

<h2> Group Management </h2>

<p> These pages can be used to create and manage groups for sharing files, and also to authorize guest users.</p>

<form th:action="@{/groups/showgroups}" method="post" id="deleteForm" style="display:none">
<input type="text" name="del" id="deleteInput"/>
<input type="submit" id="deleteSubmit"/>
</form>

<form th:action="@{/groups/showgroups}" method="post">

<div th:if="${groups != null and groups.size() > 0}">

<h3>Current groups owned by you</h3>

<div class="inset" style="padding-top:0.5em">

<div th:each="g : ${groups}">

<a th:href="@{showgroup(name=${g.cn[0]})}"><span th:text="${g.cn[0]}"/></a>
<span th:text="${g['gidnumber']?.get(0)}"/>
<img role="button" tabindex="0" style="height:1em;margin-left:1em" src="delete.png" th:title="${'Delete group ' + g.cn[0]}" class="deleteButton"/>
<input type="hidden" name="deleteName" th:value="${g.cn[0]}"/>

</div>
</div>
</div>

<h3 style="margin-top:2em"> Add Group </h3>

<div class="inset" style="margin-top:1em">
<label>Group Name: <input type="text" name="name" id="name"/></label>
<br/>
<label><input type="checkbox" name="sharing" id="sharing"/> Group should be available for file sharing.</label>
<br/>
<label><input type="checkbox" name="guests" id="guests"/> Users in group may be guests. Accounts for them will be added if they don't already exist.</label>
<p>
<input type="submit" id="submit"/>
</p>
</div>
</form>
<div class="explanation" style="margin-top:2em">
<p> When adding a group, at least one of the boxes should be checked. </p>
<p> "Users in group may be guests" means that members of this group
are alloweed as guests, even if they wouldn't normally be able to login.
If you edit the group, you'll be able to choose which clusters they can
login to.</p>
</div>
</div>
